-- Destructive DDL: deletes all old tables and creates new ones: Deletion fo tables in opposite order of creation
DROP TABLE Rental;
DROP TABLE Book;
DROP TABLE Customer;
DROP TABLE Shelf;

-- ==== DEFINITIONS ====

CREATE TABLE Shelf (
Id NUMBER GENERATED BY DEFAULT AS IDENTITY,
ShelfName VARCHAR2(100),
Capacity NUMBER,

CONSTRAINT PK_Shelf PRIMARY KEY (id)
);

-- QUICK FIX: USE ALTERS DIRECTLY UNDER TABLE CREATION
-- ALTER TABLE SHELF DROP COLUMN DESCRIPTION;
-- ALTER TABLE SHELF ADD Capacity NUMBER;

CREATE TABLE Customer (
Id NUMBER GENERATED BY DEFAULT AS IDENTITY,
FirstName VARCHAR2(100),
LastName VARCHAR2(100),
DateOfBirth DATE,
libraryNumber NUMBER,

CONSTRAINT PK_Customer PRIMARY KEY (id)
);

-- ALTER TABLE CUSTOMER ADD FIRSTNAME VARCHAR2(100);

CREATE TABLE Book (
Id NUMBER GENERATED BY DEFAULT AS IDENTITY,
Isbn VARCHAR2(20),
Title VARCHAR2(500),
Subtitle VARCHAR2(500),
AuthorLastName VARCHAR(100),

ShelfId NUMBER,

CONSTRAINT PK_Book PRIMARY KEY (id),
CONSTRAINT FK_Book_Shelf FOREIGN KEY (ShelfId) REFERENCES SHELF
);


-- ALTER TABLE BOOK ADD SUBTITLE VARCHAR2(500);
-- ALTER TABLE book MODIFY Title varchar2(500);


CREATE TABLE Rental (
CustomerId NUMBER,
BookId NUMBER,
RentDate DATE,
ReturnDate DATE,

CONSTRAINT FK_Rental_Customer FOREIGN KEY (CustomerId) REFERENCES CUSTOMER,
CONSTRAINT FK_Rental_Book FOREIGN KEY (BookId) REFERENCES BOOK
);

